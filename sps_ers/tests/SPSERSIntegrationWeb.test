<?php
class SPSERSIntegrationWebTest extends DrupalWebTestCase {
  static function getInfo() {
    return array(
      'name' => 'SPS ERS Integration Web Tests',
      'description' => 'Test the ERS integration.',
      'group' => 'SPSPostTests',
    );
  }

  public function setUp() {
      parent::setUp("iib", "sps", "sps_test", "ctools", "ers");
  }

  public function testERSTableData() {
    $basic = array(
      array('node', 2, 13, 1343157649, 1),
      array('node', 2, 0, 1343167026, 1),
      array('node', 3, 8, time() + 5000, 0),
      array('node', 3, 0, time() + 5000, 0),
    );

    foreach ($basic as $entry) {
      drupal_write_record('ers_schedule', $entry);
    }

    
  }

  // public function testERSForms() {
  //   $user = $this->drupalCreateUser(array(
  //     'administer ers',
  //     'bypass node access',
  //     'administer site configuration',
  //     'administer nodes',
  //     'view revisions'
  //   ));
  //   $this->drupalLogin($user);

  //   variable_set('ers_entity_bundle_node' , array('article' => 'article','page' => 'page'));

  //   //create an article
  //   $values = array(
  //     'title' => 'first rev',
  //     'body[und][0][value]' => 'testing rev1',
  //   );

  //   $this->drupalPost('node/add/article', $values, t('Save'));

  //   $this->drupalGet('node/1');
  //   $this->assertText('testing rev1', 'Node should be successfully created', 'Checkpoint');
  //   $this->drupalGet('node/1/revisions');
  //   $this->drupalGet('node/1/revisions/1/publish');
  //   $this->drupalPost('node/1/revisions/1/publish', array(), t('Schedule'));
  //   $values = array(
  //     'title' => 'second rev',
  //     'body[und][0][value]' => 'testing rev2',
  //     'revision' => TRUE,
  //   );

  //   $this->drupalPost('node/1/edit', $values, t('Save'));


  //   $test_time = time() + 5000;
  //   $this->drupalGet('node/1/revisions');
  //   $values = array(
  //     'ers_schedule_time[date]' => date('m/j/Y', $test_time),
  //     'ers_schedule_time[time]' => '01:00',
  //   );
  //   //gets permission denied here
  //   $this->drupalPost('node/1/revisions/2/publish', $values, t('Schedule'));
  // }
}
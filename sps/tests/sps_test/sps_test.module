<?php

function sps_test_menu() {
  return array(
    'test_sps' => array(
      'title' => 'Test SPS Preview Form',
      'description' => '',
      'page callback' => 'sps_test_test_widget_form',
      'access callback' => TRUE,
    ),
  );
}

function sps_test_test_widget_form() {
  $plugins = array(
    'override' => array(
      'test1' => array(
        'name' => 'test1',
        'condition' => 'BasicCondition',
        'class' => '\Drupal\sps\Test\Override',
        'instance_settings' => array(
          'type' => 'node',
        ),
      ),
      'test2' => array(
        'name' => 'test2',
        'condition' => 'BasicCondition',
        'class' => '\Drupal\sps\Test\Override',
        'instance_settings' => array(
          'type' => 'box',
        ),
      ),
    ),
    'condition' => array(
      'basic' => array(
        'name' => 'basic',
        'class' => '\Drupal\sps\Plugins\Condition\BasicCondition',
        'instance_settings' => array(
          'widget' => 'basicWidget',
          'name' => 'basic',
        ),
      ),
    ),
    'widget' => array(
      'basicWidget' => array(
        'name' => 'basicWidget',
        'class' => '\Drupal\sps\Plugins\Widget\DateWidget',
        'instance_settings' => array(),
      ),
    )
  );
  $plugin_controller = new Drupal\sps\Test\PluginController($plugins);
  $hook_controller = new Drupal\sps\DrupalHookController();
  $manager = new Drupal\sps\Test\Manager(NULL, NULL, NULL, $plugin_controller, $hook_controller);
  $manager->config_controller->set(SPS_CONFIG_ROOT_CONDITION, array('name' => 'basic'));
  return $manager->getPreviewForm();
}
